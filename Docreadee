import pandas as pd
from docx import Document

def extract_tables_from_word(docx_path):
    """
    Extracts all tables from a .docx file and returns a list of pandas DataFrames.
    """
    doc = Document(docx_path)
    tables = []

    for i, table in enumerate(doc.tables):
        data = []
        for row in table.rows:
            data.append([cell.text.strip() for cell in row.cells])
        
        if not data:
            continue  # Skip empty tables

        headers = data[0]
        rows = data[1:] if len(data) > 1 else []

        df = pd.DataFrame(rows, columns=headers)
        df['Table_Index'] = i + 1  # Add index for traceability
        tables.append(df)

    return tables

def combine_and_export_to_excel(tables, output_excel_path):
    """
    Combines all DataFrames into one Excel sheet and writes to output path.
    """
    if not tables:
        print("No tables found in the Word document.")
        return

    combined_df = pd.concat(tables, ignore_index=True)
    combined_df.to_excel(output_excel_path, index=False)
    print(f"âœ… Excel file saved to: {output_excel_path}")

# === Example Usage ===
if __name__ == "__main__":
    input_docx = "your_document.docx"               # Replace with your input file
    output_excel = "combined_word_tables.xlsx"

    tables = extract_tables_from_word(input_docx)
    combine_and_export_to_excel(tables, output_excel)
