from docx import Document
import pandas as pd

def extract_tables_from_docx(docx_path):
    doc = Document(docx_path)
    tables_data = []

    for idx, table in enumerate(doc.tables):
        data = []
        for row in table.rows:
            data.append([cell.text.strip() for cell in row.cells])
        
        # Convert to DataFrame
        if len(data) >= 2:  # At least 1 header and 1 row
            df = pd.DataFrame(data[1:], columns=data[0])
        elif len(data) == 1:
            df = pd.DataFrame(columns=data[0])
        else:
            continue

        df["Source_Table_Index"] = idx + 1  # Add source index
        tables_data.append(df)

    return tables_data

def combine_tables_and_save(tables, output_excel_path):
    if not tables:
        print("No tables found.")
        return
    combined_df = pd.concat(tables, ignore_index=True)
    combined_df.to_excel(output_excel_path, index=False)
    print(f"Excel file saved at: {output_excel_path}")

# === USAGE ===
docx_file_path = "input.docx"       # Replace with your Word file path
output_excel_path = "combined_tables.xlsx"

tables = extract_tables_from_docx(docx_file_path)
combine_tables_and_save(tables, output_excel_path)
